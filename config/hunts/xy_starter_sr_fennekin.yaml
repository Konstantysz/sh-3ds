hunt_id: "xy_starter_sr_fennekin"
hunt_name: "Pokemon X/Y Starter Soft Reset (Fennekin)"
target_pokemon: "fennekin"
screen_mode: "dual"

# Regions of Interest (normalized 0.0-1.0, extracted on both warped screens)
rois:
  - name: "top_full"
    x: 0.05
    y: 0.05
    w: 0.9
    h: 0.9
  - name: "top_strip"
    x: 0.1
    y: 0.05
    w: 0.8
    h: 0.12
  - name: "starters_area"
    x: 0.2
    y: 0.3
    w: 0.6
    h: 0.4
  - name: "bottom_prompt"
    x: 0.20
    y: 0.30
    w: 0.60
    h: 0.28
  - name: "dialogue"
    x: 0.1
    y: 0.75
    w: 0.8
    h: 0.2
  - name: "pokemon_sprite"
    x: 0.3
    y: 0.3
    w: 0.4
    h: 0.4

# FSM state detection parameters (HSV ranges tuned per state)
debounce_frames: 3
fsm_states:
  load_game:
    top:
      roi: "top_strip"
      method: "color_histogram"
      hsv_lower: [60, 60, 190]
      hsv_upper: [90, 100, 255]
      threshold: 0.6

  game_start:
    top:
      roi: "top_strip"
      method: "color_histogram"
      hsv_lower: [75, 0, 210]
      hsv_upper: [110, 45, 255]
      threshold: 0.6

  cutscene_part_1:
    top:
      roi: "top_full"
      method: "color_histogram"
      hsv_lower: [0, 0, 41]
      hsv_upper: [180, 255, 255]
      threshold: 0.5

  starter_pick:
    top:
      roi: "starters_area"
      method: "color_histogram"
      hsv_lower: [100, 80, 180]
      hsv_upper: [118, 115, 225]
      threshold: 0.5
    bottom:
      roi: "bottom_prompt"
      method: "color_histogram"
      hsv_lower: [95, 40, 165]
      hsv_upper: [130, 150, 240]
      threshold: 0.5

  cutscene_part_2:
    top:
      roi: "top_full"
      method: "color_histogram"
      hsv_lower: [0, 0, 41]
      hsv_upper: [180, 255, 255]
      threshold: 0.5

  nickname_prompt:
    top:
      roi: "top_strip"
      method: "color_histogram"
      hsv_lower: [100, 75, 165]
      hsv_upper: [120, 105, 200]
      threshold: 0.5

  cutscene_part_3:
    top:
      roi: "top_full"
      method: "color_histogram"
      hsv_lower: [0, 0, 41]
      hsv_upper: [180, 255, 255]
      threshold: 0.5

  party_menu:
    top:
      roi: "top_strip"
      method: "color_histogram"
      hsv_lower: [96, 130, 180]
      hsv_upper: [112, 165, 225]
      threshold: 0.6

  pokemon_summary:
    top:
      roi: "pokemon_sprite"
      method: "color_histogram"
      hsv_lower: [100, 70, 165]
      hsv_upper: [120, 105, 215]
      threshold: 0.3

  soft_reset:
    top:
      roi: "top_full"
      method: "color_histogram"
      hsv_lower: [0, 0, 0]
      hsv_upper: [180, 255, 40]
      threshold: 0.95

# Shiny detector (dominant color method)
# Based on projected hardware shift (Gamma 1.3, WB)
# Normal (Yellowish) -> Shifts to Cyan/Blue (~110)
# Shiny (Greyish/Reddish) -> Shifts further or desaturates
shiny_detector:
  method: "dominant_color"
  roi: "pokemon_sprite"
  weight: 1.0
  normal_hsv_lower: [100, 60, 150]
  normal_hsv_upper: [120, 120, 230]
  shiny_hsv_lower: [120, 40, 150]
  shiny_hsv_upper: [140, 100, 230]
  shiny_ratio_threshold: 0.15
  normal_ratio_threshold: 0.15

fusion:
  shiny_threshold: 0.55
  uncertain_threshold: 0.35

# Input actions per FSM state
actions:
  load_game:
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500

  game_start: []

  cutscene_part_1:
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500

  starter_pick:
    - buttons: ["D_RIGHT"]
      hold_ms: 100
      wait_after_ms: 500
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500

  cutscene_part_2:
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500

  nickname_prompt:
    - buttons: ["B"]
      hold_ms: 100
      wait_after_ms: 500

  cutscene_part_3:
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500

  party_menu:
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 500
    - buttons: ["A"]
      hold_ms: 100
      wait_after_ms: 1000

  pokemon_summary: []

  soft_reset:
    - buttons: ["L", "R", "START"]
      hold_ms: 500
      wait_after_ms: 2000

# Hunt behaviour
shiny_check_state: "pokemon_summary"
shiny_check_frames: 30
shiny_check_delay_ms: 1000
on_shiny_action: "stop"

recovery:
  on_stuck:
    action: "soft_reset"
    max_retries: 5
  on_detection_failure:
    action: "skip"
    max_consecutive: 10
